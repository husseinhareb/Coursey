<div class="forum-list">
  <h3>
    <i class="fas fa-comments"></i>
    {{ 'FORUM.LIST_TITLE' | translate }}
  </h3>

  <button
    *ngIf="canCreateTopic"
    (click)="toggleNewTopicForm()"
    class="btn btn--toggle"
  >
    <i class="fas" [ngClass]="showNewTopicForm ? 'fa-times' : 'fa-plus'"></i>
    {{ showNewTopicForm ? ('FORUM.CANCEL' | translate) : ('FORUM.NEW_TOPIC' | translate) }}
  </button>

  <div *ngIf="showNewTopicForm" class="new-topic-form">
    <form [formGroup]="newTopicForm" (ngSubmit)="createTopic()">
      <div class="form-group">
        <label for="title">
          <i class="fas fa-heading"></i>
          {{ 'FORUM.TITLE_LABEL' | translate }}
        </label>
        <input
          id="title"
          formControlName="title"
          placeholder="{{ 'FORUM.TITLE_PLACEHOLDER' | translate }}"
        />
        <div
          *ngIf="newTopicForm.get('title')?.touched && newTopicForm.get('title')?.invalid"
          class="error"
        >
          <i class="fas fa-exclamation-circle"></i>
          {{ 'FORUM.TITLE_ERROR' | translate }}
        </div>
      </div>
      <button
        type="submit"
        class="btn btn--submit"
        [disabled]="newTopicForm.invalid"
      >
        <i class="fas fa-paper-plane"></i>
        {{ 'FORUM.CREATE_BUTTON' | translate }}
      </button>
    </form>
  </div>

  <!-- ... loading / error ... -->

  <ul *ngIf="!loading && !error" class="topics">
    <li
      *ngFor="let topic of topics"
      (click)="goToTopic(topic._id)"
      class="topic-item"
    >
      <i class="fas fa-comment-alt topic-icon"></i>
      <div class="topic-body">
        <strong>{{ topic.title }}</strong>
        <small>
          <i class="fas fa-user"></i>
          {{ authorNames[topic.author_id] }}
          &nbsp;•&nbsp;
          <i class="fas fa-calendar-alt"></i>
          {{ topic.created_at | date:'short' }}
          &nbsp;•&nbsp;
          <i class="fas fa-comments"></i>
          {{ topic.messages.length || 0 }}
        </small>
      </div>
    </li>
  </ul>

  <div *ngIf="!loading && topics.length === 0" class="no-topics">
    <i class="fas fa-info-circle"></i>
    <p>{{ 'FORUM.NO_TOPICS' | translate }}</p>
  </div>
</div>
