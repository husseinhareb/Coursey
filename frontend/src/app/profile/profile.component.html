<!-- src/app/profile/profile.component.html -->

<div class="profile-container">
  <h2 class="profile-header">My Profile</h2>

  <div *ngIf="loading" class="message">Loading profile…</div>
  <div *ngIf="error"   class="message error">{{ error }}</div>

  <form *ngIf="!loading" [formGroup]="form" (ngSubmit)="onSubmit()">
    <!-- Avatar -->
    <div class="avatar-container">
      <div class="avatar">
        <img
          *ngIf="user?.profile?.profilePic; else showInitials"
          [src]="user!.profile!.profilePic!"
          alt="Profile Picture"
        />
        <ng-template #showInitials>
          {{ initials }}
        </ng-template>
      </div>
    </div>

    <!-- Readonly -->
    <div class="profile-field">
      <label>Email</label>
      <input type="email" [value]="user?.email" disabled />
    </div>
    <div class="profile-field">
      <label>Username</label>
      <input type="text"  [value]="user?.username" disabled />
    </div>

    <!-- Editable -->
    <div class="profile-field">
      <label for="firstName">First Name</label>
      <input id="firstName" formControlName="firstName" />
    </div>
    <div class="profile-field">
      <label for="lastName">Last Name</label>
      <input id="lastName"  formControlName="lastName" />
    </div>
    <div class="profile-field">
      <label for="phoneNumber">Phone Number</label>
      <input id="phoneNumber" formControlName="phoneNumber" />
    </div>
    <div class="profile-field">
      <label for="address">Address</label>
      <input id="address"    formControlName="address" />
    </div>

    <!-- Roles -->
    <div class="profile-field">
      <label>Roles</label>
      <ul class="profile-list">
        <li *ngFor="let role of user?.roles">{{ role }}</li>
      </ul>
    </div>

    <!-- Enrolled Courses -->
    <div class="profile-field">
      <label>Enrolled Courses</label>
      <ul class="profile-list">
        <li *ngFor="let c of enrolledCourses">
          {{ c.code }} – {{ c.title }}
        </li>
      </ul>
    </div>

    <div class="profile-actions">
      <button type="submit" [disabled]="form.invalid">Save Changes</button>
    </div>
  </form>

  <div *ngIf="success" class="message success">
    Profile updated successfully.
  </div>
</div>
